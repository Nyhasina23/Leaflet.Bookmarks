!function t(o,e,n){function s(a,r){if(!e[a]){if(!o[a]){var l="function"==typeof require&&require;if(!r&&l)return l(a,!0);if(i)return i(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var u=e[a]={exports:{}};o[a][0].call(u.exports,function(t){var e=o[a][1][t];return s(e?e:t)},u,u.exports,t,o,e,n)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)s(n[a]);return s}({1:[function(t){(function(o){var e=o.L||t("leaflet");e.Control.Bookmarks=t("./src/bookmarks")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./src/bookmarks":2,leaflet:void 0}],2:[function(t,o){(function(e){var n=e.L||t("leaflet"),s=t("./storage"),i=t("./formpopup"),a=t("./string").substitute,r=n.Control.extend({statics:{Storage:s,FormPopup:i},options:{localStorage:!0,name:"leaflet-bookmarks",position:"topright",containerClass:"leaflet-bar leaflet-bookmarks-control",expandedClass:"expanded",formPopup:{popupClass:"bookmarks-popup"},bookmarkTemplate:'<li class="{{ itemClass }}"><span class="{{ removeClass }}">&times;</span><span class="{{ nameClass }}">{{ data.name }}</span><span class="{{ coordsClass }}">{{ data.coords }}</span></li>',bookmarkTemplateOptions:{itemClass:"bookmark-item",nameClass:"bookmark-name",coordsClass:"bookmark-coords",removeClass:"bookmark-remove"},listClass:"bookmarks-list",iconClass:"icon",title:"Bookmarks"},initialize:function(t){this._list=null,this._marker=null,this._storage=this.options.localStorage?new s(this.options.name,s.engineType.LOCALSTORAGE):new s(this.options.name,s.engineType.XHR,this.options.storageUrl),n.Util.setOptions(this,t),n.Control.prototype.initialize.call(this,this.options)},onAdd:function(t){var o=this._container=n.DomUtil.create("div",this.options.containerClass);return n.DomEvent.disableClickPropagation(o).disableScrollPropagation(o),o.innerHTML='<span class="'+this.options.iconClass+'"></span>',o.title=this.options.title,this._createList(this.options.bookmarks),n.DomEvent.on(o,"click",this._onClick,this),n.DomEvent.on(o,"contextmenu",n.DomEvent.stopPropagation),t.on("bookmark:new",this._onBookmarkAddStart,this),t.on("bookmark:add",this._onBookmarkAdd,this),o},onRemove:function(t){t.off("bookmark:new",this._onBookmark,this),t.off("bookmark:add",this._onBookmarkAdd,this),n.DomEvent.off(this._container,"click",this._onClick,this),this._marker=null,this._popup=null,this._container=null},_createList:function(t){this._list=n.DomUtil.create("ul",this.options.listClass,this._container),n.Util.isArray(t)?this._appendItems(t):"function"==typeof t?this._appendItems(t()):this._storage.getAllItems(this._appendItems.bind(this))},_appendItems:function(t){for(var o,e="",n=0,s=t.length;s>n;n++)o=t[n],this.options.bookmarkTemplateOptions.data={coords:this.formatCoords(o.latlng),name:this.formatName(o.name)},e+=a(this.options.bookmarkTemplate,this.options.bookmarkTemplateOptions);this._list.innerHTML+=e},formatCoords:function(t){return this.options.formatCoords?this.options.formatCoords.call(this,t):t[0]+", "+t[1]},formatName:function(t){return this.options.formatName?this.options.formatName.call(this,t):t},expand:function(){n.DomUtil.addClass(this._container,this.options.expandedClass)},collapse:function(){n.DomUtil.removeClass(this._container,this.options.expandedClass)},_onClick:function(){n.DomUtil.hasClass(this._container,this.options.expandedClass)?this.collapse():this.expand()},_onBookmarkAddStart:function(t){this._marker=new n.Marker(t.latlng,{icon:this.options.icon||new n.Icon.Default,draggable:!0,riseOnHover:!0}).addTo(this._map),this._marker.on("popupclose",this._onPopupClosed,this),this._popup=new n.Control.Bookmarks.FormPopup(this.options.formPopup,this._marker).addTo(this._map)},_onBookmarkAdd:function(t){var o=this;t=this._cleanBookmark(t.data),this._storage.setItem(t.name,t,function(t){o._appendItems([t])})},_cleanBookmark:function(t){return n.Util.isArray(t.latlng)||(t.latlng=[t.latlng.lat,t.latlng.lng]),t},_onPopupClosed:function(){this._map.removeLayer(this._marker)}});o.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./formpopup":3,"./storage":5,"./string":8,leaflet:void 0}],3:[function(t,o){(function(e){var n=e.L||t("leaflet"),s=t("./string").substitute,i=t("./string").unique,a=n.Popup.extend({options:{className:"leaflet-bookmarks-form-popup",templateOptions:{formClass:"leaflet-bookmarks-form",inputClass:"leaflet-bookmarks-form-input",coordsClass:"leaflet-bookmarks-form-coords",submitClass:"leaflet-bookmarks-form-submit",inputPlaceholder:"Bookmark name",submitText:"+"},generateNames:!0,template:'<form class="{{ formClass }}"><div class="{{ coordsClass }}">{{ coords }}</div><input type="text" name="bookmark-name" placeholder="{{ inputPlaceholder }}" class="{{ inputClass }}"><input type="submit" value="{{ submitText }}" class="{{ submitClass }}"></form>'},initialize:function(t,o){t.offset=this._calculateOffset(o,t),this._latlng=o.getLatLng(),n.Popup.prototype.initialize.call(this,t,o)},_calculateOffset:function(t,o){var e=n.point(t.options.icon.options.popupAnchor||[0,0]);return e=e.add(this.options.offset),o&&o.offset&&(e=e.add(o.offset)),e},_updateContent:function(){this._content=s(this.options.template,n.Util.extend({},this.options.templateOptions,{coords:this.formatCoords(this._source.getLatLng())})),n.Popup.prototype._updateContent.call(this);var t=this._contentNode.querySelector("."+this.options.templateOptions.formClass);n.DomEvent.on(t,"submit",this._onSubmit,this)},_onSubmit:function(t){n.DomEvent.stop(t);var o=this._contentNode.querySelector("."+this.options.templateOptions.inputClass);""===o.value&&this.options.generateNames&&(o.value=i()),""!==o.value&&(this._map.fire("bookmark:add",{data:{latlng:this._source.getLatLng(),name:o.value}}),this._close())},formatCoords:function(t){return this.options.formatCoords?this.options.formatCoords.call(this,t):t.toString()},onAdd:function(t){return this._source.on("dragend",this._onSourceMoved,this),this._source.on("dragstart",this._onSourceMoveStart,this),n.Popup.prototype.onAdd.call(this,t)},onRemove:function(t){this._source.off("dragend",this._onSourceMoved,this),n.Popup.prototype.onRemove.call(this,t)},_onSourceMoveStart:function(){this._container.style.display="none"},_onSourceMoved:function(){this._latlng=this._source.getLatLng(),this._container.style.display="",this.update()}});o.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./string":8,leaflet:void 0}],4:[function(t,o){var e={},n=function(t){this._prefix=t};n.prototype.getItem=function(t,o){o(e[this._prefix+t])},n.prototype.setItem=function(t,o,n){e[this._prefix+t]=o,n(o)},n.prototype.getAllItems=function(t){var o=[];for(var n in e)e.hasOwnProperty(n)&&0===n.indexOf(this_prefix)&&o.push(e[n]);t(o)},n.prototype.removeItem=function(t,o){this.getItem(t,function(n){n?delete e[this._prefix+t]:n=null,o&&o(n)})},o.exports=n},{}],5:[function(t,o){(function(e){var n=t("./string").unique,s=function(t,o){"string"!=typeof t&&(o=t,t=n()),this._name=t,this._engine=s.createEngine(o,this._name,Array.prototype.slice.call(arguments,2))};s.engineType={GLOBAL:1,LOCALSTORAGE:2,XHR:3},s.Engine={Global:t("./storage.global"),XHR:t("./storage.xhr"),LocalStorage:t("./storage.localstorage")},s.createEngine=function(t,o){return t===s.engineType.GLOBAL?new s.Engine.Global(o):t===s.engineType.LOCALSTORAGE?new s.Engine.LocalStorage(o):t===s.engineType.XHR?new s.Engine.XHR(Array.prototype.slice.call(arguments,1)):void 0},s.prototype.setItem=function(t,o,e){return this._engine.setItem(t,o,e),this},s.prototype.getItem=function(t,o){return this._engine.getItem(t,o),this},s.prototype.getAllItems=function(t){this._name;this._engine.getAllItems(t)},o.exports=e.Storage=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./storage.global":4,"./storage.localstorage":6,"./storage.xhr":7,"./string":8}],6:[function(t,o){var e=function(t){this._prefix=t,this._storage=window.localStorage};e.JSON_RE=/^[\{\[](.)*[\]\}]$/,e.prototype.getItem=function(t,o){var n=this._storage.getItem(this._prefix+t);n&&e.JSON_RE.test(n)&&(n=JSON.parse(n)),o(n)},e.prototype.getAllItems=function(t){var o=[],e=this._prefix.length;for(var n in this._storage)this._storage.hasOwnProperty(n)&&0===n.indexOf(this._prefix)&&this.getItem(n.substring(e),function(t){o.push(t)});t(o)},e.prototype.removeItem=function(t,o){var e=this;this._storage.getItem(t,function(n){e._storage.removeItem(this._prefix+t),o&&o(n)})},e.prototype.setItem=function(t,o,e){var n=o.toString();"[object Object]"===n&&(n=JSON.stringify(o)),this._storage.setItem(this._prefix+t,n),e(o)},o.exports=e},{}],7:[function(t,o){var e=function(t,o,e){this._getUrl=t,this._postUrl=o||t,this._deleteUrl=e||t};e.prototype.getItem=function(t,o){ajax.get(this._getUrl,{key:t},o)},e.prototype.setItem=function(t,o,e){ajax.post(this._postUrl,{key:o},e)},e.prototype.removeItem=function(t,o){ajax.delete(this._deleteUrl,{key:t},o)},e.prototype.getAllItems=function(t){ajax.get(this._getUrl,null,t)},o.exports=e},{}],8:[function(t,o){function e(t,o,e){return t.replace(e||/{{([\s\S]+?)}}/g,function(t,e){if(e=s(e),-1===e.indexOf("."))return"\\"==t.charAt(0)?t.slice(1):null!=o[e]?o[e]:"";var n=o;e=e.split(".");for(var i=0,a=e.length;a>i;i++){if(!(e[i]in n))return"";n=n[e[i]]}return n})}function n(){var t="abcdefghijklmnopqrstuvwxyz";return t[Math.floor(Math.random()*t.length)]+(new Date).getTime().toString(16)}function s(t){return t.replace(/^\s+|\s+$/g,"")}function i(t){return s(t.replace(/\s+/g," "))}o.exports={substitute:e,trim:s,clean:i,unique:n}},{}]},{},[1]);